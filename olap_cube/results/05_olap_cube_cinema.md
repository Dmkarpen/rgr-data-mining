# OLAP-куб для даних кінотеатру та базові OLAP-операції

## Використані виміри та міри

**Виміри (Dimensions):** `year`, `month`, `day_of_week`, `movie_title`, `genre`.

**Міри (Measures):**
- `total_tickets_sold` — сумарна кількість проданих квитків (SUM)
- `total_revenue` — сумарна виручка (SUM), де `revenue = ticket_price × tickets_sold`
- `avg_occupancy` — середня заповненість залу (AVG)

## Фрагмент OLAP-куба (перші 20 рядків)

Нижче наведено приклад структури куба після агрегації за вимірами.

|    |   year |   month | day_of_week   | movie_title   | genre       |   total_tickets_sold |   total_revenue |   avg_occupancy |
|---:|-------:|--------:|:--------------|:--------------|:------------|---------------------:|----------------:|----------------:|
|  0 |   2024 |       1 | Fri           | Cartoon Fun   | Animation   |                   76 |        15132.36 |           38.00 |
|  1 |   2024 |       1 | Fri           | Deep Ocean    | Documentary |                   72 |         5498.64 |           36.00 |
|  2 |   2024 |       1 | Fri           | Love in Paris | Romance     |                   80 |        12453.60 |          100.00 |
|  3 |   2024 |       1 | Fri           | Mystery Case  | Detective   |                   84 |        10726.80 |           56.00 |
|  4 |   2024 |       1 | Fri           | Rock Legends  | Musical     |                  164 |        19273.21 |           36.45 |
|  5 |   2024 |       1 | Fri           | Space Odyssey | Sci-Fi      |                  174 |        27570.88 |           81.34 |
|  6 |   2024 |       1 | Mon           | Cartoon Fun   | Animation   |                   70 |        13071.10 |           35.00 |
|  7 |   2024 |       1 | Mon           | Deep Ocean    | Documentary |                   80 |        12991.20 |          100.00 |
|  8 |   2024 |       1 | Mon           | Love in Paris | Romance     |                  240 |        45555.50 |           69.97 |
|  9 |   2024 |       1 | Mon           | Mystery Case  | Detective   |                  105 |         7491.75 |           70.00 |
| 10 |   2024 |       1 | Mon           | Rock Legends  | Musical     |                  244 |        26062.08 |           48.80 |
| 11 |   2024 |       1 | Mon           | Space Odyssey | Sci-Fi      |                  201 |        22214.04 |           66.20 |
| 12 |   2024 |       1 | Sat           | Cartoon Fun   | Animation   |                   80 |        12798.40 |          100.00 |
| 13 |   2024 |       1 | Sat           | Deep Ocean    | Documentary |                  198 |        31310.46 |           55.20 |
| 14 |   2024 |       1 | Sat           | Haunted Manor | Horror      |                   80 |         6660.80 |          100.00 |
| 15 |   2024 |       1 | Sat           | Love in Paris | Romance     |                  135 |        24889.10 |           33.75 |
| 16 |   2024 |       1 | Sun           | Cartoon Fun   | Animation   |                   57 |         8893.14 |           47.50 |
| 17 |   2024 |       1 | Sun           | Deep Ocean    | Documentary |                   79 |        10838.01 |           31.60 |
| 18 |   2024 |       1 | Sun           | Haunted Manor | Horror      |                   58 |        11594.78 |           72.50 |
| 19 |   2024 |       1 | Sun           | Love in Paris | Romance     |                  163 |        19570.59 |           61.75 |

## OLAP-операція: SLICE (зріз)

Зріз виконується шляхом фіксації окремих значень вимірів.

У цьому прикладі зафіксовано:
- `year = 2024`
- `movie_title = "Love in Paris"`

Результат показує агреговані значення для обраного фільму в обраному році у розрізі інших вимірів (місяць, день тижня, жанр).

|    |   year |   month | day_of_week   | movie_title   | genre   |   total_tickets_sold |   total_revenue |   avg_occupancy |
|---:|-------:|--------:|:--------------|:--------------|:--------|---------------------:|----------------:|----------------:|
|  0 |   2024 |       1 | Fri           | Love in Paris | Romance |                   80 |        12453.60 |          100.00 |
|  1 |   2024 |       1 | Mon           | Love in Paris | Romance |                  240 |        45555.50 |           69.97 |
|  2 |   2024 |       1 | Sat           | Love in Paris | Romance |                  135 |        24889.10 |           33.75 |
|  3 |   2024 |       1 | Sun           | Love in Paris | Romance |                  163 |        19570.59 |           61.75 |
|  4 |   2024 |       1 | Thu           | Love in Paris | Romance |                  169 |        18861.34 |           60.92 |
|  5 |   2024 |       1 | Tue           | Love in Paris | Romance |                   53 |         8997.28 |           35.33 |
|  6 |   2024 |       1 | Wed           | Love in Paris | Romance |                  223 |        36377.13 |           42.94 |
|  7 |   2024 |       2 | Fri           | Love in Paris | Romance |                  123 |        15150.23 |           30.75 |
|  8 |   2024 |       2 | Mon           | Love in Paris | Romance |                  307 |        54655.81 |           58.20 |
|  9 |   2024 |       2 | Sat           | Love in Paris | Romance |                   59 |         7154.34 |           29.50 |
| 10 |   2024 |       2 | Sun           | Love in Paris | Romance |                   46 |        11646.74 |           38.33 |
| 11 |   2024 |       2 | Thu           | Love in Paris | Romance |                   80 |         9785.60 |          100.00 |
| 12 |   2024 |       2 | Tue           | Love in Paris | Romance |                   92 |        16928.92 |           36.80 |
| 13 |   2024 |       2 | Wed           | Love in Paris | Romance |                  234 |        45130.60 |           55.03 |
| 14 |   2024 |       3 | Mon           | Love in Paris | Romance |                   80 |        12178.40 |          100.00 |
| 15 |   2024 |       3 | Sat           | Love in Paris | Romance |                  170 |        28859.50 |           38.00 |
| 16 |   2024 |       3 | Thu           | Love in Paris | Romance |                   29 |         3596.87 |           36.25 |
| 17 |   2024 |       3 | Tue           | Love in Paris | Romance |                  193 |        27953.00 |           43.90 |
| 18 |   2024 |       3 | Wed           | Love in Paris | Romance |                  167 |        26251.35 |           62.25 |
| 19 |   2024 |       4 | Fri           | Love in Paris | Romance |                   59 |         9454.16 |           23.60 |
| 20 |   2024 |       4 | Mon           | Love in Paris | Romance |                  175 |        21527.11 |           41.72 |
| 21 |   2024 |       4 | Sat           | Love in Paris | Romance |                  111 |        17686.94 |           42.17 |
| 22 |   2024 |       4 | Sun           | Love in Paris | Romance |                  203 |        38165.29 |           45.08 |
| 23 |   2024 |       4 | Thu           | Love in Paris | Romance |                   95 |        19605.15 |           79.17 |
| 24 |   2024 |       4 | Tue           | Love in Paris | Romance |                  104 |        13714.48 |           52.00 |
| 25 |   2024 |       4 | Wed           | Love in Paris | Romance |                  173 |        26955.13 |           37.95 |
| 26 |   2024 |       5 | Fri           | Love in Paris | Romance |                  395 |        53067.91 |           51.37 |
| 27 |   2024 |       5 | Mon           | Love in Paris | Romance |                  222 |        36297.60 |           49.33 |
| 28 |   2024 |       5 | Sun           | Love in Paris | Romance |                   80 |        13408.00 |          100.00 |
| 29 |   2024 |       5 | Thu           | Love in Paris | Romance |                  270 |        33397.52 |           46.56 |

## OLAP-операція: DRILL-DOWN (деталізація)

Деталізація (drill-down) дозволяє перейти від більш загального рівня до детальнішого.

У цьому прикладі для `year = 2024` виконано деталізацію за часом:
`year → month → day_of_week`.

Нижче наведено зведену таблицю виручки (SUM) за місяцями та днями тижня.

|   month |        Mon |        Tue |        Wed |        Thu |        Fri |        Sat |        Sun |
|--------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|
|       1 | 127,385.67 | 107,303.37 | 189,034.29 | 139,084.13 |  90,655.49 |  75,658.76 | 173,967.26 |
|       2 | 163,344.17 | 150,056.85 | 109,526.42 | 180,784.28 | 194,744.12 | 132,291.45 | 148,717.30 |
|       3 |  31,618.62 | 156,870.77 |  87,952.38 |  87,595.28 |  81,437.98 | 100,756.91 | 118,261.73 |
|       4 |  84,138.36 |  55,365.58 | 179,031.69 | 137,137.67 | 216,726.50 | 229,083.49 | 136,482.01 |
|       5 | 174,822.10 | 166,116.75 | 231,225.52 | 152,636.56 | 147,500.12 | 124,377.00 | 135,360.11 |
|       6 | 119,780.29 |  79,647.38 | 105,706.84 |  52,733.51 | 175,837.76 | 109,188.69 | 209,364.78 |
|       7 | 149,326.68 | 135,440.84 | 131,374.70 | 150,012.17 |  60,659.05 | 148,551.24 | 152,401.27 |
|       8 | 172,530.64 | 172,358.11 | 136,028.76 | 203,923.49 | 100,806.37 | 252,609.16 |  92,657.39 |
|       9 | 147,021.06 | 127,954.74 | 179,327.70 | 136,402.31 | 141,793.74 | 108,190.24 | 118,370.78 |
|      10 | 280,598.97 |  95,397.71 |  37,574.96 | 113,233.27 | 125,198.36 | 101,172.08 | 166,227.29 |
|      11 |  77,205.33 | 143,991.00 | 128,083.04 |  66,704.64 | 157,462.71 | 166,783.65 |  82,732.25 |
|      12 | 107,786.34 | 107,904.80 | 192,058.96 | 126,382.77 | 158,414.80 | 124,069.82 | 155,565.45 |

## OLAP-операція: ROLL-UP (агрегація / згортання)

Агрегація (roll-up) дозволяє піднятися на вищий рівень узагальнення.

У цьому прикладі дані згорнуто до рівня `year × genre` з такими мірами:
- `total_revenue` (SUM)
- `total_tickets_sold` (SUM)
- `avg_occupancy` (AVG)

|    |   year | genre       |   total_revenue |   total_tickets_sold |   avg_occupancy |
|---:|-------:|:------------|----------------:|---------------------:|----------------:|
|  0 |   2024 | Action      |    1,586,140.55 |                10647 |           54.50 |
|  2 |   2024 | Detective   |    1,560,472.58 |                10622 |           57.49 |
|  3 |   2024 | Documentary |    1,545,542.83 |                10611 |           55.15 |
|  6 |   2024 | Romance     |    1,545,431.36 |                10366 |           52.18 |
|  5 |   2024 | Musical     |    1,429,650.90 |                 9921 |           54.53 |
|  7 |   2024 | Sci-Fi      |    1,292,658.66 |                 8368 |           55.95 |
|  1 |   2024 | Animation   |    1,247,123.45 |                 8491 |           53.96 |
|  4 |   2024 | Horror      |    1,194,578.25 |                 7769 |           52.84 |

## OLAP-операція: ROTATE / PIVOT (обертання вимірів)

Операція rotate/pivot змінює представлення даних: виміри можуть мінятися місцями між рядками та стовпцями.

У цьому прикладі побудовано зведену таблицю, де:
- рядки: `movie_title`
- стовпці: `day_of_week`
- значення: середня заповненість `avg(occupancy)`

| movie_title    |   Mon |   Tue |   Wed |   Thu |   Fri |   Sat |   Sun |
|:---------------|------:|------:|------:|------:|------:|------:|------:|
| Cartoon Fun    | 44.38 | 54.81 | 57.19 | 62.44 | 50.19 | 56.76 | 50.79 |
| Deep Ocean     | 60.09 | 51.38 | 50.35 | 56.81 | 53.90 | 57.21 | 55.45 |
| Haunted Manor  | 61.90 | 45.87 | 44.70 | 60.83 | 58.23 | 51.46 | 43.89 |
| Love in Paris  | 54.15 | 42.26 | 57.67 | 56.21 | 47.62 | 45.39 | 57.05 |
| Mystery Case   | 61.24 | 53.67 | 51.45 | 58.10 | 69.16 | 55.97 | 53.07 |
| Rock Legends   | 50.95 | 54.80 | 51.34 | 59.10 | 58.43 | 45.64 | 58.65 |
| Space Odyssey  | 52.60 | 52.13 | 60.47 | 55.81 | 57.90 | 56.52 | 59.12 |
| Thunder Strike | 55.22 | 44.43 | 49.02 | 68.22 | 43.53 | 62.61 | 56.53 |

